{"name": "VERIFY_ATTRIBUTE", "example": "", "module": "class VERIFY_ATTRIBUTE():\n    step_name = 'VERIFY_ATTRIBUTE'\n\n    def __init__(self):\n        print(f'Registering {self.step_name} step')\n\n    def expand_box(self,box,img_size,factor=1.5):\n        W,H = img_size\n        x1,y1,x2,y2 = box\n        dw = int(factor*(x2-x1)/2)\n        dh = int(factor*(y2-y1)/2)\n        cx = int((x1 + x2) / 2)\n        cy = int((y1 + y2) / 2)\n        x1 = max(0,cx - dw)\n        x2 = min(cx + dw,W)\n        y1 = max(0,cy - dh)\n        y2 = min(cy + dh,H)\n        return [x1,y1,x2,y2]\n\n    def predict(self,img,boxes,obj,question):\n        if len(boxes) > 0:\n            prompt = f'Tell me the attributes of the {obj} in one sentence.'\n            object_description = API.gpt3(prompt, 'gpt3_general')\n            box = boxes[0]\n            box = self.expand_box(box, img.size)\n            out_img = img.crop(box)\n            result = API.clip(out_img,object_description)\n        else:\n            # result = API.vqa(img,question)\n            prompt = f'Tell me the attributes of the {obj} in one sentence.'\n            object_description = API.gpt3(prompt, 'gpt3_general')\n            result = API.clip(img,object_description)\n        return result\n\n    def execute(self,img,boxes,obj,question):\n        result = self.predict(img,boxes,obj,question)\n        if result > 0.6:\n            flag = True\n        else:\n            flag = False\n        # if len(boxes) > 0:\n        #     if result > 0.6:\n        #         flag = True\n        #     else:\n        #         flag = False\n        # else:\n        #     if 'yes' in result.lower():\n        #         flag = True\n        #     else:\n        #         flag = False\n        return flag", "program": "BOX0=LOC(image=IMAGE,object='coat')\nANSWER0=VERIFY_ATTRIBUTE(image=IMAGE, box=BOX0,object='thick coat',question=\"Does the coat look thick?\")\nANSWER1=EVAL(expr=f\"'yes' if {ANSWER0} else 'no'\")\nFINAL_RESULT=RESULT(var=ANSWER1)", "head": "class VERIFY_ATTRIBUTE():\n\t\"\"\"\n\tInput:\n        image: an image object\n        box: a list of bounding boxes\n        object: a string\n        question: a string\n    Output:\n        flag: True if the material is correct else False\n\tExamples:\n        Question: Does the coat look thick?\n        BOX0=LOC(image=IMAGE,object='coat')\n        ANSWER0=VERIFY_ATTRIBUTE(image=IMAGE, box=BOX0,object='thick coat',question=\"Does the coat look thick?\")\n        ANSWER1=EVAL(expr=f\"'yes' if {ANSWER0} else 'no'\")\n        FINAL_RESULT=RESULT(var=ANSWER1)\n\t\"\"\""}