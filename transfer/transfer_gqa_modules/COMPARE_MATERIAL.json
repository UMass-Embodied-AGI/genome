{"name": "COMPARE_MATERIAL", "example": "", "module": "class COMPARE_MATERIAL():\n    step_name = 'COMPARE_MATERIAL'\n\n    def __init__(self):\n        print(f'Registering {self.step_name} step')\n\n    def expand_box(self,box,img_size,factor=1.5):\n        W,H = img_size\n        x1,y1,x2,y2 = box\n        dw = int(factor*(x2-x1)/2)\n        dh = int(factor*(y2-y1)/2)\n        cx = int((x1 + x2) / 2)\n        cy = int((y1 + y2) / 2)\n        x1 = max(0,cx - dw)\n        x2 = min(cx + dw,W)\n        y1 = max(0,cy - dh)\n        y2 = min(cy + dh,H)\n        return [x1,y1,x2,y2]\n\n    def predict(self,img,boxes1,boxes2,obj1,obj2,question):\n        if len(boxes1) > 0:\n            box1 = boxes1[0]\n            box1 = self.expand_box(box1,img.size)\n            out_img1 = img.crop(box1)\n        else:\n            out_img1 = img\n\n        if len(boxes2) > 0:\n            box2 = boxes2[0]\n            box2 = self.expand_box(box2,img.size)\n            out_img2 = img.crop(box2)\n        else:\n            out_img2 = img\n\n        material1 = API.vqa(out_img1, f'What material is the {obj1} made of?')\n        material2 = API.vqa(out_img2, f'What material is the {obj2} made of?')\n\n        prompt = f'Can the {material1} be regarded as the same material as {material2}? You should just reply yes or no without any other words.'\n        temp = API.gpt3(prompt, 'gpt3_general')\n\n        if 'same' in question.lower():\n            if 'yes' in temp.lower():\n                result = 'yes'\n            elif 'no' in temp.lower():\n                result = 'no'\n        elif 'different' in question.lower():\n            if 'yes' in temp.lower():\n                result = 'no'\n            elif 'no' in temp.lower():\n                result = 'yes'\n        else:\n            if 'yes' in temp.lower():\n                result = 'yes'\n            elif 'no' in temp.lower():\n                result = 'no'\n\n        return result\n\n    def execute(self,img,boxes1,boxes2,obj1,obj2,question):\n        result = self.predict(img,boxes1,boxes2,obj1,obj2,question)\n        return result", "program": "BOX0=LOC(image=IMAGE,object='building')\nBOX1=LOC(image=IMAGE,object='log')\nANSWER0=COMPARE_MATERIAL(image=IMAGE,box1=BOX0,box2=BOX1,object1='building',object2='log',question=\"Are the building and the log made of the same material?\")\nFINAL_RESULT=RESULT(var=ANSWER0)", "head": "class COMPARE_MATERIAL():\n\t\"\"\"\n\tInput:\n        image: an image object\n        box1: a list of bounding boxes\n        box2: a list of bounding boxes\n        object1: a string\n        object2: a string\n        question: a string\n    Output:\n        result: a string\n\tExamples:\n        Question: Are the building and the log made of the same material?\n        BOX0=LOC(image=IMAGE,object='building')\n        BOX1=LOC(image=IMAGE,object='log')\n        ANSWER0=COMPARE_MATERIAL(image=IMAGE,box1=BOX0,box2=BOX1,object1='building',object2='log',question=\"Are the building and the log made of the same material?\")\n        FINAL_RESULT=RESULT(var=ANSWER0)\n\t\"\"\""}