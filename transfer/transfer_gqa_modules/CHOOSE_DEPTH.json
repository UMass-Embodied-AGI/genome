{"name": "CHOOSE_DEPTH", "example": "", "module": "class CHOOSE_DEPTH():\n    step_name = 'CHOOSE_DEPTH'\n\n    def __init__(self):\n        print(f'Registering {self.step_name} step')\n\n    def predict(self,img,boxes1,boxes2,question):\n        if len(boxes1) > 0 and len(boxes2) > 0:\n            box1 = boxes1[0]\n            box2 = boxes2[0]\n            out_img1 = img.crop(box1)\n            out_img2 = img.crop(box2)\n            depth_map1 = API.depth(out_img1)\n            depth_map2 = API.depth(out_img2)\n            left1 = 0\n            lower1 = 0\n            right1 = out_img1.size[1]  # width\n            upper1 = out_img1.size[0]  # height\n            left2 = 0\n            lower2 = 0\n            right2 = out_img2.size[1]  # width\n            upper2 = out_img2.size[0]  # height\n            depth_map1 = depth_map1[out_img1.size[0]-upper1:out_img1.size[0]-lower1,\n                                    left1:right1]\n            depth_map2 = depth_map2[out_img2.size[0]-upper2:out_img2.size[0]-lower2,\n                                    left2:right2]\n            depth1 = depth_map1.median()\n            depth2 = depth_map2.median()\n            if depth1 < depth2:\n                result = 'front'\n            else:\n                result = 'behind'\n        else:\n            temp = API.vqa(img,question)\n            if 'front' in temp.lower():\n                result = 'front'\n            elif 'behind' in temp.lower():\n                result = 'behind'\n        return result\n\n    def execute(self,img,boxes1,boxes2,question):\n        result = self.predict(img,boxes1,boxes2,question)\n        return result", "program": "BOX0=LOC(image=IMAGE,object='RIGHT')\nIMAGE0=CROP(image=IMAGE,box=BOX0)\nBOX1=LOC(image=IMAGE0,object='metal fence')\nBOX2=LOC(image=IMAGE0,object='person')\nANSWER0=CHOOSE_DEPTH(image=IMAGE0,box1=BOX1,box2=BOX2,question='Is the metal fence in front or behind the person on the right?')\nFINAL_RESULT=RESULT(var=ANSWER0)", "head": "class CHOOSE_DEPTH():\n\t\"\"\"\n\tInput:\n        image: an image object\n        box1: a list of bounding boxes\n        box2: a list of bounding boxes\n        question: a string\n    Output:\n        result: a string\n\tExamples:\n        Question: Is the metal fence in front or behind the person on the right?\n        BOX0=LOC(image=IMAGE,object='RIGHT')\n        IMAGE0=CROP(image=IMAGE,box=BOX0)\n        BOX1=LOC(image=IMAGE0,object='metal fence')\n        BOX2=LOC(image=IMAGE0,object='person')\n        ANSWER0=CHOOSE_DEPTH(image=IMAGE0,box1=BOX1,box2=BOX2,question='Is the metal fence in front or behind the person on the right?')\n        FINAL_RESULT=RESULT(var=ANSWER0)\n\t\"\"\""}